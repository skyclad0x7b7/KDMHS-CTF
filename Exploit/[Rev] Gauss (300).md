## [Rev] Gauss (300)

**gauss.cpp**
```c++
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int encode_0(char, int);
int encode_1(int);
int encode_2(int);
int encode_3(int);
int encode_4(int);
int encode_5(int);
int encode_6(int);


int main(int argc, char *argv[])
{
	if(argc != 2) {
		printf("[*] Usage : %s [FLAG]\n", argv[0]);
		return 0;
	}
	bool ok = true;
	char *arg = (char *)malloc(36+1);
	int *encoded = (int *)malloc(36 * sizeof(int));
	int flag[36] = {-6052972,-15378558,-22159833,-30775398,-36888367,-47107730,-54322624,-60859955,-68718019,-75393136,-85214655,-93743209,-100985722,-111078663,-119560006,-126056768,-133372787,-140466792,-150374773,-158279230,-167702626,-170491341,-183066828,-191341263,-198538836,-201896377,-208032339,-218146696,-226771716,-232669417,-241296094,-248187956,-253545033,-259326678,-264556281,-271760208};
	strncpy(arg, argv[1], 36);
	int i=0;
	while(i < 36) {
		if(i == 0) encoded[i] = encode_0(arg[i], 0);
		else encoded[i] = encode_0(arg[i], encoded[i-1]);
		if(flag[i] != encoded[i]) {
			printf("Wrong...\n");
			ok = false;
			break;
		}
		i++;
	}
	if(ok) printf("Yeah, Good!\n");
	free(encoded);
	free(arg);
	return 0;
}

... functions ...
```

This file receives the flag by argv[1].  
And calculates a lot.  
It seemed hard to make an inverse operation.  
Yeah, you don't have to make it.  

There's two way to solve it.  
First, substituting one by one in regular order until find right one. (1-byte bruteforce)  
Second, counting the number of instructions operated using pintool.  
You can use the example of pintool, **inscount**.  

This is the source of second way.
```python
import os
import time

t_ran = "_{}()abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 !#$%&\'*+,-./:;<=>?@[]^|~"
ran = []

for i in t_ran:
	ran.append(ord(i))


#=========================================

TARGET = "/home/skyclad/target/gauss"
PIN = "/home/skyclad/tools/pin/pin"
SO_FILE = "/home/skyclad/tools/pin/source/tools/skyclad_count/obj-ia32/MyPinTool.so"
COUNT_FILE = "/home/skyclad/tools/pin/source/tools/skyclad_count/obj-ia32/count"
ARG = ""

#=========================================

flag = ""

startTime = int(time.time())
print "[*][*] Started at " + str(startTime);

for j in range(36):
	for i in range(len(ran)):
		command = "{0} -t {1} -- {2} \"{3}\" > /dev/null".format(PIN, SO_FILE, TARGET, ARG+chr(ran[i]))
		os.system(command)
		f = open('count', 'r')
		count = int(f.read())
		#print ARG+chr(ran[i]), count
		if i == 0:
			curr = count
			continue
		else:
			prev = curr
			curr = count
		if abs(curr-prev) > 5000:
			if curr > prev:
				print "[*] Guess..." + ARG+chr(ran[i])
				ARG += chr(ran[i])
				flag += chr(ran[i])
				break
			else:
				print "[*] Guess..." + ARG+chr(ran[i-1])
				ARG += chr(ran[i-1])
				flag += chr(ran[i-1])
				break

print "[*] Found String : " + flag

endTime = int(time.time())

print "[*][*] Ended at " + str(endTime)
print "[*][*] Found in " + str(endTime-startTime) + " seconds"
```